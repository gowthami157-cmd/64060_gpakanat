---
output:
  pdf_document: default
  html_document: default
---
```{r}
library(factoextra)
library(tidyverse)
library(ggplot2)
library(readr)

# Load the dataset
pharmaceuticals_data <- read.csv("C:\\Users\\pakan\\Desktop\\FML\\Pharmaceuticals.csv")
p_data<-na.omit(pharmaceuticals_data)
summary(p_data)

```

After removing the missing values from the data, we need to focus on the quantitative variables (1-9) to group the 21 companies.

```{r}
row.names(p_data) <- p_data[,1]
pharmaceuticals_data<- p_data[,3:11]
head(pharmaceuticals_data)
```

All the numerical variables in the dataframe have been successfully scaled.

```{r}
Pharma_data<-scale(pharmaceuticals_data)
head(Pharma_data)
```

Now, let's move on to determining the number of clusters for the Elbow Method cluster analysis.

```{r}
fviz_nbclust(Pharma_data, kmeans, method = "wss") + labs(subtitle = "Elbow Method")
```

Determining the number of clusters using the silhouette method

```{r}
fviz_nbclust(Pharma_data, kmeans, method = "silhouette")+ labs(subtitle = "Silhouette Method")
```

Based on the plots provided, it is clear that there are 5 clusters, which effectively showcase the variations in the data.

```{r}
set.seed(120)
k5_clusters<- kmeans(Pharma_data,centers=5,nstart = 25) 
#Visualize the output
k5_clusters$centers  #centroids
fviz_cluster(k5_clusters,data = Pharma_data) # to Visualize the clusters
k5_clusters
distance<- dist(Pharma_data, method = "euclidean")
fviz_dist(distance)
```


**K-Means Cluster Analysis** - here i am fitting data with 5 clusters

```{r}
fit_5c<-kmeans(Pharma_data,5)
```

Now, we can determine the average value of all numerical variables for each cluster.



```{r}
aggregate(Pharma_data,by=list(fit_5c$cluster),FUN=mean)
```
```{r}
Pharma3<-data.frame(Pharma_data,fit_5c$cluster)
Pharma3
```

To view the cluster plot

```{r}
library(cluster)
clusplot(Pharma_data,fit_5c$cluster,color = TRUE,shade = TRUE,labels = 2,lines = 0)
```
**(b):**
Interpret the clusters with respect to the numerical variables used in forming the clusters.


**solution(b):**

By examining the average values of all numerical variables for each cluster


Cluster 1 - IVX, BAY, CHTT 

Cluster 2 - LLY, NVS, SGP,WYE,ABT, AZN, BMY

Cluster 3 - MRX, ELN

Cluster 4 -  PFE, GSK,JNJ, MRK

Cluster 5 - AVE, PHA, WPI,AGN, AHM

Cluster 1: Cluster 1 has the highest Beta value  , Leverage value  and lowest Market_Cap value , ROE, ROA, Leverage, Rev_Growth, Net_Profit_Margin
Cluster 2: Cluster 2  has highest Net_Profit_Margin and lowest Beta.
Cluster 3: Here cluster 3 has highest Rev_Growth and lowest PE_Ratio, Asset_Turnover.
Cluster 4: Cluster 4  has highest Market_Cap, ROE, ROA,Asset_Turnover 
Cluster 5: Cluster 5 has higher PE_Ratio.

**(c):**Is there a pattern in the clusters with respect to the numerical variables (10 to 12)? (those not used in forming the clusters)


**Answer(c):**


There appears to be a noticeable trend in the clusters when it comes to the Media recommendation variable.

Cluster 1, which has the highest Beta and highest Leverage, is mostly recommended as a Moderate Buy.

Cluster 2, which has the highest net profit margin, predominantly has hold recommendations.

Cluster 3, which has the lowest PE_Ratio and lowest Asset_Turnover, is given a Hold Recommendation.

Cluster 4 has the highest market capitalization, return on equity, return on assets, and asset turnover. It is equally recommended to hold or moderately buy.

Cluster 5, which has the highest PE_Ratio, is strongly recommended as a great investment opportunity. This is due to the fact that a high PE_Ratio suggests that the company is experiencing rapid growth.

I noticed a pattern among the clusters when it comes to variables (10 to 12).

Clusters 1 and 4 are primarily associated with a Moderate Buy Recommendation.

Clusters 2, 3, and 4 are recommended to be held.

                                                      
**(d):**
Provide an appropriate name for each cluster using any or all of the variables in the dataset.

**Answer(d):**
Cluster1 - cluster with high Beta and leverage, or cluster to consider buying. 

Cluster2 - cluster with a high net profit margin or a high hold.

Cluster3 - Cluster with low PE ratio and high asset turnover, suitable for holding.

Cluster4 - Recommended Buy cluster

Cluster5 - cluster with a high PE_Ratio (or) high Buy cluster.


